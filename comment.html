<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed Comment Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand-blue: #006BEA;
        }
        body {
            font-family: 'Inter', sans-serif;
        }
        .step-container {
            display: none;
        }
        .step-container.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .option-btn, .checkbox-label {
            transition: all 0.2s ease-in-out;
            border: 2px solid #e5e7eb;
        }
        .option-btn:hover, .checkbox-label:hover {
            border-color: var(--brand-blue);
            background-color: rgba(0, 107, 234, 0.05);
            transform: translateY(-2px);
        }
        input[type="checkbox"]:checked + .checkbox-label, input[type="radio"]:checked + .checkbox-label {
             border-color: var(--brand-blue);
             background-color: rgba(0, 107, 234, 0.1);
        }
        .copy-btn.copied {
            background-color: #22c55e;
            color: white;
        }
        .nav-btn {
             background-color: var(--brand-blue);
             color: white;
        }
    </style>
</head>
<body class="bg-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl bg-white rounded-xl border border-gray-200 p-6 md:p-8">
        
        <div class="text-center mb-6">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800">Fixed Comment Tool</h1>
            <p class="text-gray-500 mt-1">Answer the questions to generate the correct ticket comment.</p>
        </div>

        <!-- Step 1: Main Outcome -->
        <div id="step-1" class="step-container active">
            <h2 class="font-semibold text-lg text-gray-800 mb-4">1. What was the main outcome of this service ticket?</h2>
            <div id="step-1-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
        </div>

        <!-- Step 2: Dynamic Step (Symptoms, Status, etc.) -->
        <div id="step-2" class="step-container">
            <h2 id="step-2-title" class="font-semibold text-lg text-gray-800 mb-4"></h2>
            <div id="step-2-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
        </div>
        
        <!-- Final Output Area -->
        <div id="output-container" class="step-container mt-6">
            <h2 id="output-title" class="font-semibold text-lg text-gray-800 mb-2">Final Comment:</h2>
            <div class="relative">
                <textarea id="output-desc" rows="4" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50" readonly></textarea>
                <button id="copy-btn" class="absolute top-2 right-2 bg-gray-200 text-gray-600 hover:bg-gray-300 font-semibold py-1 px-3 rounded-md text-sm transition-colors duration-200 copy-btn">Copy</button>
            </div>
        </div>
        
        <!-- Navigation -->
        <div id="nav-container" class="mt-6 pt-6 border-t border-gray-200 flex gap-4">
             <button id="back-btn" class="w-full bg-gray-100 text-gray-800 font-semibold py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors duration-200" style="display: none;">Back</button>
             <button id="next-btn" class="w-full nav-btn font-semibold py-3 px-4 rounded-lg transition-colors duration-200" style="display: none;">Next</button>
        </div>

    </div>

    <script>
        // --- DATA ---
        const commentWizardData = {
            "Education": {
                type: 'dynamic',
                template: "(SR: xxxxxxxx) [{status}] + [Customer complaint: {symptoms}] + [{status_details}: {solution}]",
                prompts: [
                    { id: 'symptoms', title: "Which symptoms did the customer report?", type: 'checkbox', options: ["Device Use", "Settings", "Cleaning", "App", "Network", "Memory", "Camera", "Battery", "Reboot", "Other"] },
                    { id: 'status', title: "Was the issue resolved?", type: 'radio', options: ["Solved", "Unsolved"] },
                    { id: 'solution', title: "What was the solution or advice given?", type: 'textarea', placeholder: "e.g., Explained how to clear cache..." }
                ]
            },
            "Software Update": {
                type: 'dynamic',
                template: "(SR: xxxxxxxx) Software update [{status}] + [Symptom: {symptoms}] + [Comment: {solution}]",
                prompts: [
                    { id: 'symptoms', title: "What was the related symptom?", type: 'radio', options: ["App", "Network", "Memory", "Camera", "Battery", "Reboot", "Other"] },
                    { id: 'status', title: "Was the issue resolved by the update?", type: 'radio', options: ["Solved", "Unsolved"] },
                    { id: 'solution', title: "Add a brief comment on the outcome.", type: 'textarea', placeholder: "e.g., Issue resolved after update..." }
                ]
            },
            "Accessory Exchange": {
                type: 'static',
                prompt: "Which accessory was exchanged?",
                options: {
                    "Cable USB A - USB Micro White": "(SR: xxxxxxxx) Cable USB A - USB Micro White | GH39-01801B",
                    "Cable USB A - USB C": "(SR: xxxxxxxx) Cable USB A - USB C | GH39-01949A",
                    "Cable USB C - USB C": "(SR: xxxxxxxx) Cable USB C - USB C | GH39-02077A",
                    "Black Fast Charger USB A": "(SR: xxxxxxxx) Black Fast Charger USB A | GH44-02950A",
                    "Black Super-Fast Charger USB C": "(SR: xxxxxxxx) Black Super-Fast Charger USB C | GH44-03053A",
                    "Standard Headset Black": "(SR: xxxxxxxx) Standard Headset Black | GH59-15061A",
                    "AKG Headset USB C": "(SR: xxxxxxxx) AKG Headset USB C | GH59-15252A",
                }
            },
            "Loyalty Solution": { type: 'static', comment: "(SR: xxxxxxxx) [Trade-Up / EPP Sale] + [New Model]" },
            "Data Service": {
                 type: 'static',
                 prompt: "Which data service was performed?",
                 options: {
                    "Smart Switch": "(SR: xxxxxxxx) Smart Switch",
                    "Data Transfer (Paid)": "(SR: xxxxxxxx) Paid Premium Service: Data transfer 15,-"
                 }
            },
            "Premium Service (Paid)": {
                type: 'static',
                prompt: "Which premium service was performed?",
                options: {
                    "Device Health Care": "(SR: xxxxxxxx) Paid Premium Service: Device health care 15,-",
                    "Buds Cleaning": "(SR: xxxxxxxx) Paid Premium Service: OOW buds cleaning 30,-",
                }
            },
            "Leadpassing": { type: 'static', comment: "(SR: xxxxxxxx) Clearcoat Leadpassing" },
            "Reschedule Appointment": { type: 'static', comment: "(SR: xxxxxxxx) Reschedule: [new date] + [Reason]" }
        };

        // --- STATE ---
        let wizardState = {};
        let currentDynamicStep = 0;

        // --- DOM ELEMENTS ---
        const step1 = document.getElementById('step-1');
        const step2 = document.getElementById('step-2');
        const step1Options = document.getElementById('step-1-options');
        const step2Title = document.getElementById('step-2-title');
        const step2Options = document.getElementById('step-2-options');
        const outputContainer = document.getElementById('output-container');
        const outputDesc = document.getElementById('output-desc');
        const backBtn = document.getElementById('back-btn');
        const nextBtn = document.getElementById('next-btn');
        const copyBtn = document.getElementById('copy-btn');
        const outputTitle = document.getElementById('output-title');

        // --- CORE LOGIC ---
        function renderStep1() {
            step1Options.innerHTML = '';
            for (const key in commentWizardData) {
                const button = document.createElement('button');
                button.className = 'option-btn p-4 rounded-lg text-left font-semibold text-gray-700';
                button.textContent = key;
                button.dataset.key = key;
                step1Options.appendChild(button);
            }
        }

        function handleStep1Click(event) {
            const button = event.target.closest('.option-btn');
            if (!button) return;

            const key = button.dataset.key;
            wizardState.mainCategory = key;
            const selection = commentWizardData[key];

            if (selection.type === 'static' && selection.comment) {
                showOutput(selection.comment, "Final Comment:");
            } else if (selection.type === 'static' && selection.options) {
                renderStaticStep2(selection.prompt, selection.options);
                goToStep(2);
            } else if (selection.type === 'dynamic') {
                startDynamicFlow();
            }
        }
        
        function renderStaticStep2(prompt, options) {
            step2Title.textContent = `2. ${prompt}`;
            step2Options.innerHTML = '';
            for (const subKey in options) {
                const button = document.createElement('button');
                button.className = 'option-btn p-4 rounded-lg text-left font-semibold text-gray-700';
                button.textContent = subKey;
                button.dataset.comment = options[subKey];
                step2Options.appendChild(button);
            }
        }

        function handleStep2Click(event) {
            const button = event.target.closest('.option-btn');
            if (!button) return;
            const comment = button.dataset.comment;
            showOutput(comment, "Final Comment:");
        }

        function startDynamicFlow() {
            currentDynamicStep = 0;
            wizardState.symptoms = [];
            wizardState.status = '';
            wizardState.solution = '';
            renderDynamicStep();
            goToStep(2);
        }

        function renderDynamicStep() {
            const prompts = commentWizardData[wizardState.mainCategory].prompts;
            const promptConfig = prompts[currentDynamicStep];
            
            step2Title.textContent = `${currentDynamicStep + 2}. ${promptConfig.title}`;
            step2Options.innerHTML = '';

            if (promptConfig.type === 'checkbox' || promptConfig.type === 'radio') {
                promptConfig.options.forEach(opt => {
                    const label = document.createElement('label');
                    label.innerHTML = `
                        <input type="${promptConfig.type}" name="${promptConfig.id}" value="${opt}" class="sr-only">
                        <div class="checkbox-label p-4 rounded-lg text-left font-semibold text-gray-700 cursor-pointer">${opt}</div>
                    `;
                    step2Options.appendChild(label);
                });
                
                // Add logic for 'Other' text area
                if (promptConfig.options.includes("Other")) {
                    const otherTextarea = document.createElement('textarea');
                    otherTextarea.id = 'other-symptom-text';
                    otherTextarea.className = 'w-full p-3 border border-gray-300 rounded-lg col-span-full mt-2 hidden';
                    otherTextarea.rows = 2;
                    otherTextarea.placeholder = 'Please specify other symptom...';
                    step2Options.appendChild(otherTextarea);

                    step2Options.addEventListener('change', (e) => {
                        if (e.target.value === 'Other' && e.target.checked) {
                            otherTextarea.classList.remove('hidden');
                        } else if (e.target.value === 'Other' && !e.target.checked) {
                            otherTextarea.classList.add('hidden');
                        }
                    });
                }

            } else if (promptConfig.type === 'textarea') {
                step2Options.innerHTML = `<textarea id="dynamic-textarea" class="w-full p-3 border border-gray-300 rounded-lg col-span-full" rows="3" placeholder="${promptConfig.placeholder || ''}"></textarea>`;
            }
            
            nextBtn.style.display = 'block';
            nextBtn.textContent = (currentDynamicStep === prompts.length - 1) ? 'Generate Comment' : 'Next';
        }

        function handleNextClick() {
            const prompts = commentWizardData[wizardState.mainCategory].prompts;
            const promptConfig = prompts[currentDynamicStep];

            if (promptConfig.id === 'symptoms') {
                let symptoms = Array.from(document.querySelectorAll(`input[name="symptoms"]:checked`)).map(el => el.value);
                if (symptoms.includes('Other')) {
                    const otherText = document.getElementById('other-symptom-text').value;
                    // Replace 'Other' with the actual text, if provided
                    symptoms = symptoms.filter(s => s !== 'Other');
                    if (otherText) {
                        symptoms.push(otherText);
                    }
                }
                wizardState.symptoms = symptoms;
            } else if (promptConfig.id === 'status') {
                const checked = document.querySelector(`input[name="status"]:checked`);
                wizardState.status = checked ? checked.value : '';
            } else if (promptConfig.id === 'solution') {
                wizardState.solution = document.getElementById('dynamic-textarea').value;
            }

            if (currentDynamicStep < prompts.length - 1) {
                currentDynamicStep++;
                renderDynamicStep();
            } else {
                generateDynamicComment();
            }
        }
        
        function generateDynamicComment() {
            const template = commentWizardData[wizardState.mainCategory].template;
            let finalComment = template
                .replace('{symptoms}', wizardState.symptoms.join(', '))
                .replace('{status}', wizardState.status)
                .replace('{solution}', wizardState.solution);
            
            if (wizardState.status === 'Solved') {
                finalComment = finalComment.replace('{status_details}', 'Solved');
            } else {
                finalComment = finalComment.replace('{status_details}', 'Unsolved');
            }
            
            showOutput(finalComment, "Generated Comment:");
        }

        function showOutput(comment, title) {
            outputDesc.value = comment;
            outputTitle.textContent = title;
            document.querySelectorAll('.step-container').forEach(el => el.classList.remove('active'));
            outputContainer.classList.add('active');
            backBtn.style.display = 'block';
            nextBtn.style.display = 'none';
            copyBtn.textContent = 'Copy';
            copyBtn.classList.remove('copied');
        }

        function goToStep(stepNumber) {
            document.querySelectorAll('.step-container').forEach(el => el.classList.remove('active'));
            document.getElementById(`step-${stepNumber}`).classList.add('active');
            backBtn.style.display = 'block';
        }

        function resetWizard() {
            document.querySelectorAll('.step-container').forEach(el => el.classList.remove('active'));
            step1.classList.add('active');
            backBtn.style.display = 'none';
            nextBtn.style.display = 'none';
            outputDesc.value = '';
            wizardState = {};
        }

        function copyToClipboard() {
            if (!outputDesc.value) return;
            
            const textArea = document.createElement("textarea");
            textArea.value = outputDesc.value;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                document.execCommand('copy');
                copyBtn.textContent = 'Copied!';
                copyBtn.classList.add('copied');
            } catch (err) {
                console.error('Could not copy text: ', err);
            }

            document.body.removeChild(textArea);
        }

        // --- EVENT LISTENERS ---
        step1Options.addEventListener('click', handleStep1Click);
        step2Options.addEventListener('click', handleStep2Click);
        backBtn.addEventListener('click', resetWizard);
        nextBtn.addEventListener('click', handleNextClick);
        copyBtn.addEventListener('click', copyToClipboard);

        // --- STARTUP ---
        renderStep1();

    </script>
</body>
</html>
